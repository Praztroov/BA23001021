<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="BA23001021 Yulin Zhou" />

<meta name="date" content="2023-11-29" />

<title>All homeworks</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">All homeworks</h1>
<h4 class="author">BA23001021 Yulin Zhou</h4>
<h4 class="date">2023-11-29</h4>



<div id="hw0" class="section level1">
<h1>HW0</h1>
</div>
<div id="例一" class="section level1">
<h1>例一</h1>
<p>按照 <span class="math display">\[
X\sim N(0, 9),
\\ Y = 2 + 3X + \epsilon,
\\ \epsilon \sim N(0,4)
\]</span> 来生成数据，样本量<span class="math inline">\(n =
100\)</span>。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">plot</span>(x, y)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>对数据进行线性拟合，结果如下：</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.9584 -1.3124 -0.0681  1.3607  5.0373 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.08374    0.14115   14.76   &lt;2e-16 ***
## x            2.98050    0.05001   59.60   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.996 on 198 degrees of freedom
## Multiple R-squared:  0.9472, Adjusted R-squared:  0.9469 
## F-statistic:  3552 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">plot</span>(x, y)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> fit<span class="sc">$</span>coefficients[<span class="dv">1</span>], <span class="at">b =</span> fit<span class="sc">$</span>coefficients[<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="例二" class="section level1">
<h1>例二</h1>
<p>从airquality数据集中生成测试表与测试图。</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(airquality), <span class="at">align =</span> <span class="st">&quot;c&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;测试表-airquality&quot;</span>)</span></code></pre></div>
<table>
<caption>测试表-airquality</caption>
<thead>
<tr class="header">
<th align="center">Ozone</th>
<th align="center">Solar.R</th>
<th align="center">Wind</th>
<th align="center">Temp</th>
<th align="center">Month</th>
<th align="center">Day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">41</td>
<td align="center">190</td>
<td align="center">7.4</td>
<td align="center">67</td>
<td align="center">5</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">36</td>
<td align="center">118</td>
<td align="center">8.0</td>
<td align="center">72</td>
<td align="center">5</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">12</td>
<td align="center">149</td>
<td align="center">12.6</td>
<td align="center">74</td>
<td align="center">5</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">18</td>
<td align="center">313</td>
<td align="center">11.5</td>
<td align="center">62</td>
<td align="center">5</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">14.3</td>
<td align="center">56</td>
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">28</td>
<td align="center">NA</td>
<td align="center">14.9</td>
<td align="center">66</td>
<td align="center">5</td>
<td align="center">6</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Temp)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">hist</span>(airquality<span class="sc">$</span>Ozone)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="例三" class="section level1">
<h1>例三</h1>
<p>按照 <span class="math display">\[
X\sim U(-2\pi, 2\pi),
\\Y = \sin(X) + \epsilon,
\\\epsilon\sim N(0,1)
\]</span> 生成数据，样本量<span class="math inline">\(n =
1000\)</span>。 使用LOESS方法对数据进行曲线拟合。 结果如下：</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> pi, <span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sin</span>(x) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y),</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>    <span class="at">method =</span> loess, </span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;fitted&quot;</span>),</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>    <span class="at">fun=</span>sin,</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&quot;origin&quot;</span>),</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>))</span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="课后习题" class="section level2">
<h2>课后习题</h2>
<p>利用逆变换法复现replace = TRUE时函数sample的功能。</p>
<hr />
<div id="解答" class="section level3">
<h3>解答</h3>
<p><strong>代码实现：</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>my.sample <span class="ot">&lt;-</span> <span class="cf">function</span>(x, size, <span class="at">prob =</span> <span class="cn">NA</span>){</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="co">#默认概率均分</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(prob) <span class="sc">==</span> <span class="dv">1</span>) <span class="cf">if</span>(<span class="fu">is.na</span>(prob)){ </span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    prob <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(x)) <span class="sc">/</span> <span class="fu">length</span>(x)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  }</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  </span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="cf">if</span>(</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>    <span class="fu">sum</span>(prob) <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">||</span> <span class="fu">sum</span>(prob <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  ) <span class="fu">stop</span>(<span class="st">&quot;invalid prob&quot;</span>)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  </span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(prob))<span class="co">#分布函数</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(size, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>  location <span class="ot">&lt;-</span> <span class="fu">sapply</span>(u, <span class="at">FUN =</span> df.inv, df)</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>  </span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>  <span class="fu">return</span>(x[location])</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>}</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>df.inv <span class="ot">&lt;-</span> <span class="cf">function</span>(u, df){<span class="co">#分布函数的逆</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>  uu <span class="ot">&lt;-</span> u <span class="sc">&lt;</span> df</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>  a <span class="ot">&lt;-</span> uu[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>  b <span class="ot">&lt;-</span> (<span class="sc">!</span>uu)[<span class="sc">-</span><span class="fu">length</span>(df)]</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>  </span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">which.max</span>(a <span class="sc">*</span> b))</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>测试：</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;z&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fl">0.25</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">my.sample</span>(x, size, prob)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>freq <span class="ot">&lt;-</span> <span class="fu">integer</span>(<span class="fu">length</span>(x))</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>  freq[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y <span class="sc">==</span> x[i]) <span class="sc">/</span> size</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>}</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="fu">print</span>(freq <span class="sc">-</span> prob)</span></code></pre></div>
<pre><code>## [1] -0.0010 -0.0016  0.0073  0.0018 -0.0065</code></pre>
<p><strong>样本频率对比原始频率</strong></p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>可见my.sample生成样本的频率与prob非常接近。</p>
<hr />
</div>
</div>
<div id="exercise-3.2" class="section level2">
<h2>Exercise 3.2</h2>
<p>标准Laplace分布的密度为<span class="math inline">\(f(x) =
\frac{1}{2}e^{-|x|}, x\in\mathbb{R}\)</span>。
使用逆变换法从此分布中生成容量为<span class="math inline">\(1000\)</span>的样本，
并使用本章出现过的一种方法来比较此样本与目标分布。</p>
<hr />
<div id="解答-1" class="section level3">
<h3>解答</h3>
<p><span class="math inline">\(F(x) = \int_0^tf(u)\text{d}u =
\frac{1}{2}e^x1_{\{x&lt;0\}} + (1-\frac{1}{2}e^{-x})1_{\{x\geq
0\}}\)</span>。 因此 <span class="math display">\[
F^{-1}(u) =
\left\{
\begin{aligned}
&amp;\log(2u), &amp;0&lt;u&lt;1/2
\\&amp;-\log(2(1-u)). &amp;1/2\leq u &lt; 1
\end{aligned}
\right.
\]</span></p>
<p><strong>代码实现</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(size){</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">runif</span>(size, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>))</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">integer</span>(<span class="fu">length</span>(u))</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  uu <span class="ot">&lt;-</span> u <span class="sc">&lt;</span> <span class="fl">0.5</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  x[uu] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> u[uu])</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  x[<span class="sc">!</span>uu] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> u[<span class="sc">!</span>uu]))</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  </span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>}</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">laplace</span>(<span class="dv">1000</span>)</span></code></pre></div>
<p><strong>样本频率对比目标密度</strong></p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>可见样本频率与目标密度非常接近。</p>
<p><strong>样本累积经验分布对比目标分布</strong></p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>同样非常接近。</p>
<hr />
</div>
</div>
<div id="exercise-3.7" class="section level2">
<h2>Exercise 3.7</h2>
<p>使用接受-拒绝法编写从<span class="math inline">\({\rm
Beta}(a,b)\)</span>分布中生成样本的函数。 从<span class="math inline">\({\rm Beta}(2,3)\)</span>中生成容量为<span class="math inline">\(1000\)</span>的样本，
画出直方图并对比理论密度。</p>
<hr />
<div id="解答-2" class="section level3">
<h3>解答</h3>
<p><span class="math inline">\({\rm Beta}(a,b)\)</span>的密度函数为
<span class="math display">\[
f(x;a,b) = \frac{1}{{\rm B}(a,b)} x^{a-1}(1-x)^{b-1}1_{[0, 1]}(x).
\]</span> <span class="math inline">\(a,b \geq 1\)</span>时，对<span class="math inline">\(x\)</span>求导，可知其最大值在<span class="math inline">\(x = \frac{a-1}{a+b-2}\)</span>处达到， 为 <span class="math display">\[
M(a,b) = \frac{(a-1)^{a-1}(b-1)^{b-1}}{{\rm B}(a,b)(a+b-2)^{a+b-2}}.
\]</span> 因此令<span class="math inline">\(g(x) = 1_{[0,
1]}\)</span>为<span class="math inline">\(U(0,
1)\)</span>的密度函数，<span class="math inline">\(c = M(a,b)\)</span>，
即可使用接受-拒绝法生成样本。</p>
<p><span class="math inline">\(0 &lt; a &lt; 1\)</span>或<span class="math inline">\(0 &lt; b &lt; 1\)</span>时，最大值为<span class="math inline">\(\infty\)</span>，无法使用接受-拒绝法。</p>
<p><strong>代码实现</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>beta.single <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, c){</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="cf">while</span>(<span class="cn">TRUE</span>){</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    <span class="cf">if</span>(</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>      u <span class="sc">&lt;=</span> y<span class="sc">^</span>(a<span class="dv">-1</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="sc">/</span> c</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    ) <span class="fu">return</span>(y)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  }</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>}</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>beta.sample <span class="ot">&lt;-</span> <span class="cf">function</span>(size, a, b){</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  <span class="cf">if</span>(a <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">||</span> b <span class="sc">&lt;</span> <span class="dv">1</span>) <span class="fu">stop</span>(<span class="st">&quot;invalid a or b&quot;</span>)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>  </span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>  c <span class="ot">&lt;-</span> (a<span class="dv">-1</span>)<span class="sc">^</span>(a<span class="dv">-1</span>) <span class="sc">*</span> (b<span class="dv">-1</span>)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="sc">/</span> (a<span class="sc">+</span>b<span class="dv">-2</span>)<span class="sc">^</span>(a<span class="sc">+</span>b<span class="dv">-2</span>)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">rep</span>(a, size), <span class="at">FUN =</span> beta.single, b, c)</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>  </span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>}</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">beta.sample</span>(<span class="dv">1000</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span></code></pre></div>
<p><strong>样本频率对比理论密度</strong></p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>两者很接近。</p>
<hr />
</div>
</div>
<div id="exercise-3.9" class="section level2">
<h2>Exercise 3.9</h2>
<p>Rescaled Epanechnikov 核 <span class="math display">\[
f_e(x) = \frac{3}{4}(1-x^2) 1_{[-1, 1]}(x)
\]</span> 是密度函数，可以用以下方法生成： 从<span class="math inline">\(U(-1,1)\)</span>生成i.i.d. <span class="math inline">\(U_1,U_2,U_3\)</span>。 若<span class="math inline">\(|U_3|&gt;|U_2|\)</span>且<span class="math inline">\(|U_3|&gt;|U_1|\)</span>则返回<span class="math inline">\(U_2\)</span>， 否则返回<span class="math inline">\(|U_3|\)</span>。</p>
<p>编写函数来生成此分布，并对比样本频率与理论密度。</p>
<hr />
<div id="解答-3" class="section level3">
<h3>解答</h3>
<p><strong>代码实现</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>epane <span class="ot">&lt;-</span> <span class="cf">function</span>(size){</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  U1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(size, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  U2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(size, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  U3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(size, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  </span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  uu <span class="ot">&lt;-</span> <span class="fu">abs</span>(U3) <span class="sc">&gt;</span> <span class="fu">abs</span>(U1) <span class="sc">&amp;</span> <span class="fu">abs</span>(U3) <span class="sc">&gt;</span> <span class="fu">abs</span>(U2)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">integer</span>(size)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  x[uu] <span class="ot">&lt;-</span> U2[uu]</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  x[<span class="sc">!</span>uu] <span class="ot">&lt;-</span> U3[<span class="sc">!</span>uu]</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>}</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">epane</span>(<span class="dv">100000</span>)</span></code></pre></div>
<p><strong>样本频率对比理论密度</strong></p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>两者非常接近。</p>
<hr />
</div>
</div>
<div id="exercise-3.10" class="section level2">
<h2>Exercise 3.10</h2>
<p>证明3.9中的方法生成的变量就服从<span class="math inline">\(f_e\)</span>。</p>
<hr />
<div id="证明" class="section level3">
<h3>证明：</h3>
<p>3.9中的方法等价于： 从<span class="math inline">\(U(0,1)\)</span>中i.i.d.生成<span class="math inline">\(X_1,X_2,X_3\)</span>，随机选出一个不是最大的，记为<span class="math inline">\(Y\)</span>； 令<span class="math inline">\(\delta\)</span>为<span class="math inline">\(\{-1,
1\}\)</span>的等概率两点分布，与<span class="math inline">\(X_1,X_2,X_3\)</span>独立； 最终输出<span class="math inline">\(X=\delta\cdot Y\)</span>。</p>
<p><span class="math inline">\(\forall x\in [0,1]\)</span>，<span class="math inline">\(Y\leq x\)</span>可分为两种情况：</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(X_1,X_2,X_3\)</span>至少有两个<span class="math inline">\(\leq x\)</span>。 概率为<span class="math inline">\(\binom{3}{2}x^2(1-x) + \binom{3}{3}x^3 = 3t^2 -
2t^3\)</span>。</p></li>
<li><p><span class="math inline">\(X_1,X_2,
X_3\)</span>中有且只有一个<span class="math inline">\(\leq
x\)</span>，且刚好被选到。 概率为<span class="math inline">\(0.5\cdot\binom{3}{1}x(1-x)^2 =
\frac{3}{2}(x^3-2t^2+x)\)</span>。</p></li>
</ol>
<p>相加即得 <span class="math display">\[
{\rm P}(Y\leq x) = \frac{3}{2}x - \frac{1}{2}x^3,\\
f_Y(x) = \frac{3}{2}(1-x^2)1_{[0,1]}(x).
\]</span> 从而 <span class="math display">\[
f_X(x) = \frac{3}{4}(1-x^2) 1_{[-1,1]}(x)=f_e(x).
\]</span></p>
<hr />
</div>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="课后习题-1" class="section level2">
<h2>课后习题</h2>
<p>在Buffon实验中，使用<span class="math inline">\(\delta\)</span>法，找到最小化<span class="math inline">\(\hat\pi\)</span>的渐近方差的<span class="math inline">\(\rho = \frac{l}{d}\)</span>。 取三个不同的<span class="math inline">\(\rho\)</span>值（包括<span class="math inline">\(\rho_{\rm min}\)</span>），使用Monte
Carlo法来验证（<span class="math inline">\(n =
10^6\)</span>，样本量<span class="math inline">\(K=100\)</span>）。</p>
<div id="解答-4" class="section level3">
<h3>解答</h3>
<p>设<span class="math inline">\(X_i\sim U(0, d/2), Y_i \sim U(0,
\pi/2), i=1,...,m\)</span>，且独立。 令<span class="math inline">\(Z_i =
1_{\{\sin Y_i \geq 2X_i \}}\)</span>， 则<span class="math inline">\(Z_i, i=1,..,m\)</span> i.i.d，且<span class="math inline">\(n = \sum_{i=1}^m Z_i\)</span>。</p>
<p><span class="math inline">\({\rm E}Z_i = \frac{2\rho}{\pi}\)</span>，
<span class="math inline">\({\rm Var}(Z_i) = \frac{2\rho}{\pi} -
\left(\frac{2\rho}{\pi}\right)^2\)</span>， 于是 <span class="math display">\[
{\rm E}\hat p = \frac{2\rho}{\pi},\\
{\rm Var}(\hat p) = \frac{2\rho}{m\pi} \left(1-\frac{2\rho}{\pi}\right).
\]</span> 由<span class="math inline">\(\delta\)</span>法，</p>
<p><span class="math display">\[
{\rm Var}(\sqrt{m} (\hat \pi - \pi)) \approx 4\rho^2 \frac{1}{(2\rho /
\pi)^4} \frac{2\rho}{m\pi} \left(1-\frac{2\rho}{\pi}\right) =
\frac{\pi^3}{2\rho} - \pi^2,
\]</span> 最小值在<span class="math inline">\(\rho =
1\)</span>处达到，为<span class="math inline">\(\frac{\pi^3}{2} -
\pi^2\)</span>。</p>
<p>选取<span class="math inline">\(\rho = 0.2, 0.5,
1\)</span>，模拟如下：</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">1</span>; m <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>pihat.var <span class="ot">&lt;-</span> <span class="fu">integer</span>(<span class="dv">0</span>)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="cf">for</span>(rr <span class="cf">in</span> rho){</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  l <span class="ot">&lt;-</span> d <span class="sc">*</span> rr</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  pihat <span class="ot">&lt;-</span> <span class="fu">integer</span>(<span class="dv">0</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>    pihat <span class="ot">&lt;-</span> <span class="fu">c</span>(pihat, <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X))</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>  }</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>  pihat.var <span class="ot">&lt;-</span> <span class="fu">c</span>(pihat.var, m <span class="sc">*</span> <span class="fu">var</span>(pihat))</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>}</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>pihat.var</span></code></pre></div>
<pre><code>## [1] 74.393564 19.071414  4.734696</code></pre>
<p>理论方差：</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>pi<span class="sc">^</span><span class="dv">3</span> <span class="sc">/</span> <span class="dv">2</span> <span class="sc">/</span> rho <span class="sc">-</span> pi<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 67.646087 21.136672  5.633534</code></pre>
<p>两者下降趋势一致，但具体数值有一定差距。</p>
<hr />
</div>
</div>
<div id="exercise-5.6" class="section level2">
<h2>Exercise 5.6</h2>
<p>要使用Monte Carlo法估计<span class="math inline">\(\theta = \int_0^1
e^x{\rm d}x\)</span>，可以应用对偶变量法。 设<span class="math inline">\(U\sim N(0,1)\)</span>，计算<span class="math inline">\({\rm Cov}(e^U, e^{1-U})\)</span>与<span class="math inline">\({\rm Var}(e^U + e^{1-U})\)</span>。
相比简单MC，使用对偶变量法可以将方差减小多少百分比？</p>
<div id="解答-5" class="section level3">
<h3>解答</h3>
<p><span class="math inline">\({\rm E}e^U ={\rm E}e^{1-U}=
e-1\)</span>，<span class="math inline">\({\rm Var}(e^U) = {\rm
Var}(e^{1-U}) = \frac{-e^2+4e-3}{2}\)</span>，于是</p>
<p><span class="math display">\[
{\rm Cov}(e^U, e^{1-U}) = \int_0^1 (e^x-e+1) (e^{1-x}-e+1){\rm d}x =  -
e^2 + 3e - 1,\\
{\rm Var}(e^U + e^{1-U}) = 2{\rm Var}(e^U) + 2{\rm Cov}(e^U, e^{1-U}) =
-3e^2 + 10e - 5.
\]</span> 相比简单MC，使用样本量缩减至一半的对偶变量法， 方差减小了<span class="math inline">\(\frac{5e^2-16e+7}{-e^2+4e-3} \approx
93.534\%\)</span>。</p>
<hr />
</div>
</div>
<div id="exercise-5.7" class="section level2">
<h2>Exercise 5.7</h2>
<p>分别使用简单MC与对偶变量法来估计5.6中的<span class="math inline">\(\theta\)</span>，并计算样本方差减小的百分比。
将结果与理论值进行对比。</p>
<div id="解答-6" class="section level3">
<h3>解答</h3>
<p>估计<span class="math inline">\(\theta\)</span>：</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>theta.mc <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(u))<span class="co">#简单MC</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>u <span class="ot">&lt;-</span> u[<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>)]<span class="co">#对偶变量法</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>theta.ant <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">exp</span>(u) <span class="sc">+</span> <span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>u)) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(theta.mc, theta.ant))</span></code></pre></div>
<pre><code>## [1] 1.717553 1.718347</code></pre>
<p>估计方差减少：</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>var.mc <span class="ot">&lt;-</span> <span class="fu">integer</span>(<span class="dv">100</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>var.ant <span class="ot">&lt;-</span> <span class="fu">integer</span>(<span class="dv">100</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  var.mc[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">exp</span>(u) <span class="sc">/</span> n)<span class="co">#简单MC</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  </span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  u <span class="ot">&lt;-</span> u[<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>)]<span class="co">#对偶变量法</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>  var.ant[i] <span class="ot">&lt;-</span> <span class="fu">var</span>((<span class="fu">exp</span>(u) <span class="sc">+</span> <span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>u)) <span class="sc">/</span> n)</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>}</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="fu">mean</span>(<span class="dv">1</span> <span class="sc">-</span> var.ant <span class="sc">/</span> var.mc)</span></code></pre></div>
<pre><code>## [1] 0.9353398</code></pre>
<p>与理论值<span class="math inline">\(93.534%\)</span>非常接近。</p>
<hr />
</div>
</div>
</div>
<div id="hw3" class="section level1">
<h1>HW3</h1>
<div id="课后习题-2" class="section level2">
<h2>课后习题</h2>
<p>在分层采样法中， <span class="math display">\[
{\rm Var}(\hat\theta^M) = \frac{1}{Mk}\sum_{i=1}^k \sigma_i^2 + {\rm
Var}(\theta_I) = {\rm Var}(\hat\theta^S) + {\rm Var}(\theta_I),
\]</span> 其中<span class="math inline">\(\theta_i = {\rm
E}(g(U)|I=i)\)</span>，<span class="math inline">\(\sigma_i^2 = {\rm
Var}(g(U)|I=i)\)</span>。</p>
<p>假设<span class="math inline">\(g\)</span>在<span class="math inline">\((a,b)\)</span>上连续， 证明<span class="math inline">\(b_i - a_i\rightarrow 0\)</span>时 <span class="math inline">\({\rm Var}(\hat{\theta}^S)/{\rm
Var}(\hat{\theta}^M)\rightarrow 0\)</span>。</p>
<hr />
<div id="证明-1" class="section level3">
<h3>证明</h3>
<p>由条件期望公式， <span class="math inline">\({\rm E}(\theta_I) = {\rm
E}({\rm E}(g(U)|I=i)) = {\rm E}(g(U)) = \theta\)</span>。</p>
<p><span class="math inline">\(\forall \epsilon &gt; 0\)</span>，<span class="math inline">\(\exists \delta &gt; 0\)</span> s.t. <span class="math inline">\(|g(x) - g(y)| &lt; \epsilon \ \forall |x-y| &lt;
\delta\)</span>。 因此<span class="math inline">\(b_i -
a_i&lt;\delta\)</span>时，<span class="math inline">\(|\theta_i -
g(a_i)| &lt; \epsilon\)</span>，<span class="math inline">\(|\theta_i -
\theta| &lt; |g(a_i)-\theta| + \epsilon\)</span>。</p>
<p>由<span class="math inline">\(a_i\)</span>的定义， <span class="math inline">\(\frac{1}{k}\sum_{i=1}^k(g(a_i)-\theta)^2
\rightarrow {\rm Var}(g(U))\)</span>， 从而<span class="math inline">\({\rm Var}(\theta_I)\rightarrow {\rm
Var}(g(U))\)</span>。 而<span class="math inline">\({\rm
Var}(\hat\theta^M)\rightarrow {\rm Var}(g(U))\)</span>， 因此<span class="math inline">\({\rm Var}(\hat{\theta}^S)/{\rm
Var}(\hat{\theta}^M)\rightarrow 0\)</span>。</p>
<hr />
</div>
</div>
<div id="exercise-5.13" class="section level2">
<h2>Exercise 5.13</h2>
<p>找到两个支撑在<span class="math inline">\((1,\infty)\)</span>上，且“接近” <span class="math display">\[
g(x) = \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}1_{\{x&gt;1\}}
\]</span> 的重要性函数<span class="math inline">\(f_1\)</span>与<span class="math inline">\(f_2\)</span>。 假设要使用重要性采样来估计<span class="math inline">\(\int_1^\infty g(x){\rm d}x\)</span>，
指出并解释使用哪个<span class="math inline">\(f\)</span>的方差更小。</p>
<hr />
<div id="解答-7" class="section level3">
<h3>解答</h3>
<p>取<span class="math inline">\(f_1(x) =
\frac{2}{\sqrt{2\pi}}e^{-(x-1)^2/2}\)</span>，<span class="math inline">\(f_2(x) = e^{-x+1}\)</span>。 <span class="math inline">\(g,f_1,f_2\)</span>的图像如下：</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="fu">plot</span>(x, g, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="fu">lines</span>(x, f1, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="fu">lines</span>(x, f2, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>  <span class="st">&quot;topright&quot;</span>,</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g&quot;</span>, <span class="st">&quot;f1&quot;</span>, <span class="st">&quot;f2&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(g/f\)</span>越接近常数，模拟得到估计的方差就越小。</p>
<p>下图为<span class="math inline">\(g/f_i\)</span>的图像：</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">plot</span>(x, g<span class="sc">/</span>f1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f2, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="st">&quot;topright&quot;</span>,</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g/f1&quot;</span>, <span class="st">&quot;g/f2&quot;</span>), <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(g/f_1\)</span>更接近常数，因此方差可能更小。</p>
<hr />
</div>
</div>
<div id="exercise-5.14" class="section level2">
<h2>Exercise 5.14</h2>
<p>使用重要性采样法来估计5.13中的<span class="math inline">\(\int_1^\infty g(x){\rm d}x\)</span>。</p>
<div id="解答-8" class="section level3">
<h3>解答</h3>
<p>取<span class="math inline">\(f\)</span>为5.13中的<span class="math inline">\(f_1\)</span>。</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>num.rep <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num.rep)</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num.rep){</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(m, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>  </span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>  mc[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(g<span class="sc">/</span>f)</span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>}</span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(mc), <span class="fu">var</span>(mc))</span></code></pre></div>
<pre><code>## [1] 4.006229e-01 1.949455e-07</code></pre>
<p>对比实际值：</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">integrate</span>(g, <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)</span></code></pre></div>
<pre><code>## 0.400626 with absolute error &lt; 5.7e-07</code></pre>
<p>两者非常接近。</p>
<hr />
</div>
</div>
<div id="exercise-5.15" class="section level2">
<h2>Exercise 5.15</h2>
<p>实现例5.13中的分层重要性采样法，并与例5.10做对比。 要估计的量为</p>
<p><span class="math display">\[
\int_0^1 \frac{e^x}{1+x^2}{\rm d}x.
\]</span></p>
<hr />
<div id="解答-9" class="section level3">
<h3>解答</h3>
<p>代码如下，输出估计及其方差：</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">1e4</span>; k <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span>k)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> theta.var <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(M<span class="sc">/</span>k, <span class="at">min =</span> xx[i], <span class="at">max =</span> xx[i<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">*</span> u)</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>  </span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>  f <span class="ot">&lt;-</span> (k<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>  theta.hat[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(g<span class="sc">/</span>f)</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>  theta.var[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(g<span class="sc">/</span>f)</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>}</span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sum</span>(theta.hat), <span class="fu">mean</span>(theta.var))</span></code></pre></div>
<pre><code>## [1] 5.250139e-01 1.704006e-05</code></pre>
<p>标准误差为</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(theta.var))</span></code></pre></div>
<pre><code>## [1] 0.004127961</code></pre>
<p>相比5.10中的各结果都要小得多。</p>
<hr />
</div>
</div>
<div id="exercise-6.5" class="section level2">
<h2>Exercise 6.5</h2>
<p>假设使用<span class="math inline">\(95\%\)</span>的<span class="math inline">\(t\)</span>区间来估计非正态数据的均值，
则此区间包含均值的概率不一定为<span class="math inline">\(95\%\)</span>。
使用MC来估计此区间包含样本量为<span class="math inline">\(20\)</span>的<span class="math inline">\(\chi^2(2)\)</span>数据的均值的概率，
并与例6.6做对比。</p>
<hr />
<div id="解答-10" class="section level3">
<h3>解答</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>num.rep <span class="ot">&lt;-</span> <span class="fl">1e4</span>; n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>), <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> num.rep, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num.rep){</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>  tt[i, ] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">+</span> t0 <span class="sc">*</span> <span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>}</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a><span class="fu">mean</span>(tt[,<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> tt[,<span class="dv">2</span>] <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.9218</code></pre>
<p>远高于例6.6中的包含概率<span class="math inline">\(77.3\%\)</span>。</p>
</div>
</div>
<div id="exercise-6.a" class="section level2">
<h2>Exercise 6.A</h2>
<p>使用MC模拟来探究：当样本非正态时，<span class="math inline">\(t\)</span>-检验的经验第一类错误是否接近名义检验水准<span class="math inline">\(\alpha\)</span>。 讨论以下三种样本： (i) <span class="math inline">\(\chi^2(1)\)</span>，(ii) <span class="math inline">\(U(0,2)\)</span>，(iii) <span class="math inline">\({\rm Exp}(1)\)</span>。 检验<span class="math inline">\(H_0: \mu = \mu_0\)</span>对<span class="math inline">\(H_1:\mu\neq \mu_0\)</span>。</p>
<hr />
<div id="解答-11" class="section level3">
<h3>解答</h3>
<p>生成样本：</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># 1: chi方 2: 均匀 3: 指数</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>samp.generate <span class="ot">&lt;-</span> <span class="cf">function</span>(num.rep, size){</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  samp <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(num.rep, size, <span class="dv">3</span>))</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num.rep){</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>    samp[i, , <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(size, <span class="at">df =</span> <span class="dv">1</span>)</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>    samp[i, , <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(size, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2</span>)</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>    samp[i, , <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">rexp</span>(size, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>  }</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>  <span class="fu">saveRDS</span>(samp, <span class="at">file =</span> <span class="st">&quot;samp.rds&quot;</span>)</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>}</span></code></pre></div>
<p>样本分析：</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>samp.analysis <span class="ot">&lt;-</span> <span class="cf">function</span>(filename, alpha){</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  samp <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(filename)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  num.rep <span class="ot">&lt;-</span> <span class="fu">dim</span>(samp)[<span class="dv">1</span>]; size <span class="ot">&lt;-</span> <span class="fu">dim</span>(samp)[<span class="dv">2</span>]</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  </span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  t0 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">df =</span> size<span class="dv">-1</span>)</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(num.rep, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>  </span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num.rep){</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> samp[j, , i]</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>    tt[j, , i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">+</span> t0 <span class="sc">*</span> <span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">sqrt</span>(size)</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>  }</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>  <span class="fu">saveRDS</span>(tt, <span class="at">file =</span> <span class="fu">paste</span>(alpha, <span class="st">&quot;interval.rds&quot;</span>, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>))</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>}</span></code></pre></div>
<p>结果整理：</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>samp.res <span class="ot">&lt;-</span> <span class="cf">function</span>(filename){</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(filename)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>  num.rep <span class="ot">&lt;-</span> <span class="fu">dim</span>(tt)[<span class="dv">1</span>]</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>  is.in <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> num.rep, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) </span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num.rep){</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>      is.in[j, i] <span class="ot">&lt;-</span> tt[j, <span class="dv">1</span>, i] <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> tt[j ,<span class="dv">2</span>, i] <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>    }</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(is.in[,<span class="dv">1</span>]), <span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(is.in[,<span class="dv">2</span>]), <span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(is.in[,<span class="dv">3</span>]))</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>  <span class="fu">saveRDS</span>(res, <span class="at">file =</span> <span class="st">&quot;result.rds&quot;</span>)</span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<p>分析结果如下。</p>
<p><span class="math inline">\(\alpha =
0.05\)</span>，各组经验第一类错误为</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a><span class="co"># 每次调用函数之前会清理所有内存。调用函数的代码已省略。</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">samp.generate</span>(<span class="at">num.rep =</span> <span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">1000</span>)</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">samp.analysis</span>(<span class="st">&quot;samp.rds&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">samp.res</span>(<span class="st">&quot;0.05 interval.rds&quot;</span>)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="do">##每个函数相互独立，只需要读取前一函数生成的文件。</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;result.rds&quot;</span>)</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## [1] 0.0496 0.0521 0.0465</code></pre>
<p>与<span class="math inline">\(\alpha\)</span>非常接近。</p>
<p>再取<span class="math inline">\(\alpha = 0.1\)</span>，结果如下：</p>
<pre><code>## [1] 0.1004 0.1030 0.0965</code></pre>
<p>结果同样与<span class="math inline">\(\alpha\)</span>非常接近。</p>
<hr />
</div>
</div>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
<div id="作业1" class="section level2">
<h2>作业1</h2>
<p>考虑 <span class="math inline">\(m = 1000\)</span> 个假设， 其中前
<span class="math inline">\(95\%\)</span> 原假设成立， 后 <span class="math inline">\(5\%\)</span> 对立假设成立。 原假设下 <span class="math inline">\(p\)</span> 值服从 <span class="math inline">\(U(0,1)\)</span> ， 对立假设下 <span class="math inline">\(p\)</span> 值服从 <span class="math inline">\({\rm
Beta}(0.1,1)\)</span> 。 将 Bonferroni 校正与 B-H 校正应用于生成的 <span class="math inline">\(m\)</span> 个独立 <span class="math inline">\(p\)</span> 值， 得到校正后的 <span class="math inline">\(p\)</span> 值，与 <span class="math inline">\(\alpha = 0.1\)</span> 比较确定是否拒绝原假设。
基于 <span class="math inline">\(M=1000\)</span> 次模拟，可估计 <span class="math inline">\({\rm FWER, FDR, TPR}\)</span> 。</p>
<hr />
<div id="解答-12" class="section level3">
<h3>解答</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="co"># bon: bonferroni bh: Benjamini-Hochberg</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span>; M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>bon.fwer <span class="ot">&lt;-</span> bh.fwer <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>bon.fdr <span class="ot">&lt;-</span> bh.fdr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>bon.tpr <span class="ot">&lt;-</span> bh.tpr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(<span class="fl">0.95</span> <span class="sc">*</span> m), <span class="fu">rbeta</span>(<span class="fl">0.05</span> <span class="sc">*</span> m, <span class="fl">0.1</span>, <span class="dv">1</span>))</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>  </span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>  p.bon <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a>  ord <span class="ot">&lt;-</span> <span class="fu">order</span>(p)</span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>  p.bh <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p[ord], <span class="at">method =</span> <span class="st">&quot;fdr&quot;</span>)</span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a>  p.bh[ord] <span class="ot">&lt;-</span> p.bh</span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>  </span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a>  bon.fwer[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">head</span>(p.bon, <span class="fl">0.95</span> <span class="sc">*</span> m) <span class="sc">&lt;</span> <span class="fl">0.1</span>) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a>  bh.fwer[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">head</span>(p.bh, <span class="fl">0.95</span> <span class="sc">*</span> m) <span class="sc">&lt;</span> <span class="fl">0.1</span>) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a>  </span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a>  bon.fdr[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">head</span>(p.bon, <span class="fl">0.95</span> <span class="sc">*</span> m) <span class="sc">&lt;</span> <span class="fl">0.1</span>) <span class="sc">/</span> <span class="fu">sum</span>(p.bon <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a>  bh.fdr[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">head</span>(p.bh, <span class="fl">0.95</span> <span class="sc">*</span> m) <span class="sc">&lt;</span> <span class="fl">0.1</span>) <span class="sc">/</span> <span class="fu">sum</span>(p.bh <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb44-24"><a href="#cb44-24" tabindex="-1"></a>  </span>
<span id="cb44-25"><a href="#cb44-25" tabindex="-1"></a>  bon.tpr[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">tail</span>(p.bon, <span class="fl">0.05</span> <span class="sc">*</span> m) <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb44-26"><a href="#cb44-26" tabindex="-1"></a>  bh.tpr[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">tail</span>(p.bh, <span class="fl">0.05</span> <span class="sc">*</span> m) <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb44-27"><a href="#cb44-27" tabindex="-1"></a>}</span>
<span id="cb44-28"><a href="#cb44-28" tabindex="-1"></a></span>
<span id="cb44-29"><a href="#cb44-29" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb44-30"><a href="#cb44-30" tabindex="-1"></a>result[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>, <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(bon.fwer), <span class="fu">mean</span>(bon.fdr), <span class="fu">mean</span>(bon.tpr)), <span class="dv">5</span>))</span>
<span id="cb44-31"><a href="#cb44-31" tabindex="-1"></a>result[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;B-H&quot;</span>, <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(bh.fwer), <span class="fu">mean</span>(bh.fdr), <span class="fu">mean</span>(bh.tpr)), <span class="dv">5</span>))</span>
<span id="cb44-32"><a href="#cb44-32" tabindex="-1"></a><span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;method&quot;</span>, <span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb44-33"><a href="#cb44-33" tabindex="-1"></a></span>
<span id="cb44-34"><a href="#cb44-34" tabindex="-1"></a></span>
<span id="cb44-35"><a href="#cb44-35" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">method</th>
<th align="center">FWER</th>
<th align="center">FDR</th>
<th align="center">TPR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Bonferroni</td>
<td align="center">0.097</td>
<td align="center">0.00495</td>
<td align="center">0.3972</td>
</tr>
<tr class="even">
<td align="center">B-H</td>
<td align="center">0.936</td>
<td align="center">0.0964</td>
<td align="center">0.56456</td>
</tr>
</tbody>
</table>
<p>使用 Bonferroni 方法得到的 <span class="math inline">\({\rm
FWER}\)</span> 很接近 <span class="math inline">\(0.1\)</span> ， <span class="math inline">\({\rm FDR}\)</span> 则远小于 <span class="math inline">\(0.1\)</span> 。</p>
<p>使用 B-H 方法得到的 <span class="math inline">\({\rm FWER}\)</span>
远大于 <span class="math inline">\(0.1\)</span> ， <span class="math inline">\({\rm FDR}\)</span> 很接近 <span class="math inline">\(0.1\)</span> 。 <span class="math inline">\({\rm
TPR}\)</span> 略高于 Bonferroni 。</p>
<hr />
</div>
</div>
<div id="作业2" class="section level2">
<h2>作业2</h2>
<p>假设总体服从 <span class="math inline">\({\rm Exp}(\lambda)\)</span>
， 则 <span class="math inline">\(\lambda\)</span> 的 <span class="math inline">\({\rm MLE}\)</span> 为 <span class="math inline">\(\hat\lambda = 1/\bar X\)</span> 。 <span class="math inline">\({\rm E}\hat\lambda = \lambda n/(n-1)\)</span> ，
所以估计的偏差为 <span class="math inline">\(\lambda/(n-1)\)</span> 。
标准误差为 <span class="math inline">\(\lambda n/
[(n-1)\sqrt{n-2}]\)</span> 。 展开模拟研究来评估 Bootstrap 的效果。</p>
<ul>
<li><span class="math inline">\(\lambda=2\)</span> 。</li>
<li>样本容量 <span class="math inline">\(n=5,10,20\)</span> 。</li>
<li>Bootstrap 重复次数 <span class="math inline">\(B = 1000\)</span>
。</li>
<li>模拟重复 <span class="math inline">\(m=1000\)</span> 次。</li>
<li>将 bootstrap 的偏差和标准误差与理论值作比较，并评价结果。</li>
</ul>
<hr />
<div id="解答-13" class="section level3">
<h3>解答</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>lam <span class="ot">&lt;-</span> <span class="dv">2</span>; nn <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span>; B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a><span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;size&quot;</span>, <span class="st">&quot;bias-bs&quot;</span>, <span class="st">&quot;se-bs&quot;</span>, <span class="st">&quot;bias-th&quot;</span>, <span class="st">&quot;se-th&quot;</span>)</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>result[, <span class="dv">1</span>] <span class="ot">&lt;-</span> nn</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>  n <span class="ot">&lt;-</span> nn[i]</span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>  bias <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>  </span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>  <span class="cf">for</span>(mm <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>    samp <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> lam)</span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>    </span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a>    lam.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a>    <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a>      samp.b <span class="ot">&lt;-</span> <span class="fu">sample</span>(samp, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a>      lam.hat[b] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(samp.b)</span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a>    }</span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a>    bias[mm] <span class="ot">&lt;-</span> <span class="fu">mean</span>(lam.hat) <span class="sc">-</span> lam</span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a>    se[mm] <span class="ot">&lt;-</span> <span class="fu">sd</span>(lam.hat)</span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a>  }</span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a>  result[i, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">mean</span>(bias), <span class="fu">mean</span>(se)), <span class="dv">5</span>)</span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a>  result[i, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(lam <span class="sc">/</span> (n<span class="dv">-1</span>), lam<span class="sc">*</span>n <span class="sc">/</span> (n<span class="dv">-1</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(n<span class="dv">-2</span>)), <span class="dv">5</span>)</span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a>}</span>
<span id="cb45-29"><a href="#cb45-29" tabindex="-1"></a></span>
<span id="cb45-30"><a href="#cb45-30" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb45-31"><a href="#cb45-31" tabindex="-1"></a><span class="co">#bs: bootstrap th: 理论值</span></span>
<span id="cb45-32"><a href="#cb45-32" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb45-33"><a href="#cb45-33" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">size</th>
<th align="center">bias-bs</th>
<th align="center">se-bs</th>
<th align="center">bias-th</th>
<th align="center">se-th</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">5</td>
<td align="center">1.10794</td>
<td align="center">3.08950</td>
<td align="center">0.50000</td>
<td align="center">1.44338</td>
</tr>
<tr class="even">
<td align="center">10</td>
<td align="center">0.41768</td>
<td align="center">0.80342</td>
<td align="center">0.22222</td>
<td align="center">0.78567</td>
</tr>
<tr class="odd">
<td align="center">20</td>
<td align="center">0.20296</td>
<td align="center">0.49787</td>
<td align="center">0.10526</td>
<td align="center">0.49622</td>
</tr>
</tbody>
</table>
<p>Bootstrap 的偏差大约是理论值的 <span class="math inline">\(2\)</span>
倍。 标准误差则在 <span class="math inline">\(n\)</span>
较大时与理论值很接近， 在 <span class="math inline">\(n\)</span>
较小时与理论值相差较大。</p>
<hr />
</div>
</div>
<div id="exercise" class="section level2">
<h2>Exercise</h2>
<p>给出例7.2中相关系数的 bootstrap <span class="math inline">\(t\)</span> 置信区间估计。</p>
<hr />
<div id="解答-14" class="section level3">
<h3>解答</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>law <span class="ot">&lt;-</span> bootstrap<span class="sc">::</span>law</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> law<span class="sc">$</span>LSAT; y <span class="ot">&lt;-</span> law<span class="sc">$</span>GPA</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span>; BB <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co">#BB: 使用bootstrap计算se的重复次数</span></span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>cor.obs <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y)</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>t <span class="ot">&lt;-</span> cor.bs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a>  samp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>  x.samp <span class="ot">&lt;-</span> x[samp]; y.samp <span class="ot">&lt;-</span> y[samp]</span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>  cor.bs[b] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x.samp, y.samp)</span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>  </span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a>  cor.rebs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(BB)</span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a>  <span class="cf">for</span>(bb <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>BB){</span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a>    resamp <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-21"><a href="#cb46-21" tabindex="-1"></a>    cor.rebs[bb] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x.samp[resamp], y.samp[resamp])</span>
<span id="cb46-22"><a href="#cb46-22" tabindex="-1"></a>  }</span>
<span id="cb46-23"><a href="#cb46-23" tabindex="-1"></a>  t[b] <span class="ot">&lt;-</span> (cor.bs[b] <span class="sc">-</span> cor.obs) <span class="sc">/</span> <span class="fu">sd</span>(cor.rebs)</span>
<span id="cb46-24"><a href="#cb46-24" tabindex="-1"></a>}</span>
<span id="cb46-25"><a href="#cb46-25" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">mean</span>(cor.bs) <span class="sc">-</span> <span class="fu">quantile</span>(t, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, alpha<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">sd</span>(cor.bs)</span>
<span id="cb46-27"><a href="#cb46-27" tabindex="-1"></a><span class="fu">names</span>(CI) <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">names</span>(CI))</span>
<span id="cb46-28"><a href="#cb46-28" tabindex="-1"></a></span>
<span id="cb46-29"><a href="#cb46-29" tabindex="-1"></a>CI</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## -0.4447980  0.9853109</code></pre>
<hr />
</div>
</div>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="exercise-7.5" class="section level2">
<h2>Exercise 7.5</h2>
<p>假设 boot 包中 aircondit 数据服从指数分布 <span class="math inline">\({\rm Exp}(\lambda)\)</span> ，
使用标准正态、基本、分位数与 <span class="math inline">\(\rm
BCa\)</span> 方法计算 <span class="math inline">\(1/\lambda\)</span> 的
<span class="math inline">\(95\%\)</span> bootstrap 置信区间。
比较并解释它们的区别。</p>
<hr />
<div id="解答-15" class="section level3">
<h3>解答</h3>
<p>对于指数分布， <span class="math inline">\(1/\lambda\)</span> 的
<span class="math inline">\({\rm MLE}\)</span> 为 <span class="math inline">\(\bar X\)</span> 。</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) <span class="fu">mean</span>(x[i,])</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> aircondit, <span class="at">statistic =</span> f, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(b, <span class="at">conf =</span> <span class="fl">0.95</span>, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a><span class="co"># CI</span></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a><span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;method&quot;</span>, <span class="st">&quot;lower&quot;</span>, <span class="st">&quot;upper&quot;</span>)</span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a>result[, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>)</span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a>result[<span class="dv">1</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(CI<span class="sc">$</span>normal[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">3</span>); result[<span class="dv">2</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(CI<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">3</span>)</span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a>result[<span class="dv">3</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(CI<span class="sc">$</span>perc[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">3</span>); result[<span class="dv">4</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(CI<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">3</span>)</span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">method</th>
<th align="center">lower</th>
<th align="center">upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">norm</td>
<td align="center">37.899</td>
<td align="center">182.528</td>
</tr>
<tr class="even">
<td align="center">basic</td>
<td align="center">32.684</td>
<td align="center">168.242</td>
</tr>
<tr class="odd">
<td align="center">perc</td>
<td align="center">47.925</td>
<td align="center">183.483</td>
</tr>
<tr class="even">
<td align="center">bca</td>
<td align="center">57.362</td>
<td align="center">217.571</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">hist</span>(b<span class="sc">$</span>t, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> b<span class="sc">$</span>t0)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Bootstrap
得到的分布与正态分布相差较大，所以正态与分位数区间有明显区别；
分布明显向左偏，而 <span class="math inline">\(\rm BCa\)</span>
对偏度与均值都有调整，所以置信区间更偏右。</p>
<hr />
</div>
</div>
<div id="exercise-7.8" class="section level2">
<h2>Exercise 7.8</h2>
<p>考虑 bootstrap 包中的 scor 数据集， 令 <span class="math inline">\(\theta = \lambda_1 /
\sum_{i=1}^5\lambda_i\)</span> ， 其中 <span class="math inline">\(\lambda_i\)</span> 为相关矩阵 <span class="math inline">\(R\)</span> 的第 <span class="math inline">\(i\)</span> 大特征值。 <span class="math inline">\(\theta\)</span> 可以使用 <span class="math inline">\(R\)</span> 的特征值来估计。 使用 jackknife 来估计
<span class="math inline">\(\hat\theta\)</span> 的偏差与标准误差。</p>
<hr />
<div id="解答-16" class="section level3">
<h3>解答</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>theta.est <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>  <span class="co">#估计theta</span></span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(v) <span class="sc">/</span> <span class="fu">sum</span>(v))</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>}</span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">theta.est</span>(scor)</span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">FUN =</span> <span class="cf">function</span>(i) <span class="fu">theta.est</span>(scor[<span class="sc">-</span>i, ]))</span>
<span id="cb50-14"><a href="#cb50-14" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (n<span class="dv">-1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta.jack) <span class="sc">-</span> theta.hat)</span>
<span id="cb50-16"><a href="#cb50-16" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">sd</span>(theta.jack)</span>
<span id="cb50-17"><a href="#cb50-17" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>(theta.hat, bias, se)</span>
<span id="cb50-19"><a href="#cb50-19" tabindex="-1"></a><span class="fu">names</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;est&quot;</span>, <span class="st">&quot;bias&quot;</span>, <span class="st">&quot;se&quot;</span>)</span>
<span id="cb50-20"><a href="#cb50-20" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>##         est        bias          se 
## 0.619115038 0.001069139 0.049836277</code></pre>
<hr />
</div>
</div>
<div id="exercise-7.11" class="section level2">
<h2>Exercise 7.11</h2>
<p>在例 7.18 中，最佳模型是用留一交叉验证来选出的。
使用留二交叉验证，并比较两个模型。</p>
<hr />
<div id="解答-17" class="section level3">
<h3>解答</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="fu">library</span>(DAAG); <span class="fu">attach</span>(ironslag)</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n <span class="sc">*</span> (n<span class="dv">-1</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a>fff <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) <span class="cf">for</span>(l <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(k, l)]</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span><span class="fu">c</span>(k, l)]</span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>  </span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(k, l)]</span>
<span id="cb52-13"><a href="#cb52-13" tabindex="-1"></a>  e1[fff] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[<span class="fu">c</span>(k, l)] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb52-14"><a href="#cb52-14" tabindex="-1"></a>  </span>
<span id="cb52-15"><a href="#cb52-15" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb52-16"><a href="#cb52-16" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(k, l)] <span class="sc">+</span></span>
<span id="cb52-17"><a href="#cb52-17" tabindex="-1"></a>    J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(k, l)]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb52-18"><a href="#cb52-18" tabindex="-1"></a>  e2[fff] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[<span class="fu">c</span>(k, l)] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb52-19"><a href="#cb52-19" tabindex="-1"></a>  </span>
<span id="cb52-20"><a href="#cb52-20" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb52-21"><a href="#cb52-21" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(k, l)]</span>
<span id="cb52-22"><a href="#cb52-22" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb52-23"><a href="#cb52-23" tabindex="-1"></a>  e3[fff] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[<span class="fu">c</span>(k, l)] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb52-24"><a href="#cb52-24" tabindex="-1"></a>  </span>
<span id="cb52-25"><a href="#cb52-25" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb52-26"><a href="#cb52-26" tabindex="-1"></a>  logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[<span class="fu">c</span>(k, l)])</span>
<span id="cb52-27"><a href="#cb52-27" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb52-28"><a href="#cb52-28" tabindex="-1"></a>  e4[fff] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[<span class="fu">c</span>(k, l)] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb52-29"><a href="#cb52-29" tabindex="-1"></a>  </span>
<span id="cb52-30"><a href="#cb52-30" tabindex="-1"></a>  fff <span class="ot">&lt;-</span> fff <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb52-31"><a href="#cb52-31" tabindex="-1"></a>}</span>
<span id="cb52-32"><a href="#cb52-32" tabindex="-1"></a></span>
<span id="cb52-33"><a href="#cb52-33" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1), <span class="fu">mean</span>(e2), <span class="fu">mean</span>(e3), <span class="fu">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436</code></pre>
<p>最佳模型也是模型 <span class="math inline">\(2\)</span> 。</p>
<hr />
</div>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
<div id="课后作业" class="section level2">
<h2>课后作业</h2>
<p>证明连续情形下 Metropolis-Hastings 算法的平稳性。</p>
<hr />
<div id="证明-2" class="section level3">
<h3>证明</h3>
<p><span class="math inline">\(r\neq s\)</span> 时，</p>
<p><span class="math display">\[\begin{aligned}
  K(s,r) f(s) &amp;= \alpha(s, r) g(r|s) f(s)
  \\&amp;= {\rm min}\left\{ \frac{f(r)g(s|r)}{f(s)g(r|s)}, 1 \right\}
g(r|s)f(s)
  \\&amp;= {\rm min}\left\{ f(r)g(s|r), f(s)g(r|s) \right\}
  \\&amp;= K(r,s)f(r).
\end{aligned}\]</span></p>
<p><span class="math inline">\(r = s\)</span> 时， <span class="math inline">\(K(s,r)f(s)\)</span> 与 <span class="math inline">\(K(r,s)f(r)\)</span> 显然相等。 平稳性得证。</p>
<hr />
</div>
</div>
<div id="exercise-8.1" class="section level2">
<h2>Exercise 8.1</h2>
<p>使用置换检验来实现 Cramér-von Mises 两样本等分布检验， 并将其应用于例
8.1 和 8.2 中的数据（chickwts）。</p>
<hr />
<div id="解答-18" class="section level3">
<h3>解答</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>cvm.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(x); n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>  F1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x); F2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>  w <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">F1</span>(x) <span class="sc">-</span> <span class="fu">F2</span>(x))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">sum</span>((<span class="fu">F1</span>(y) <span class="sc">-</span> <span class="fu">F2</span>(y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>  w <span class="ot">&lt;-</span> m<span class="sc">*</span>n <span class="sc">/</span> (m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> w</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>  <span class="fu">return</span>(w)</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>}</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>cvm.perm <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, B){</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>  perm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>  t0 <span class="ot">&lt;-</span> <span class="fu">cvm.test</span>(x, y)</span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a>  </span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(x); n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb54-17"><a href="#cb54-17" tabindex="-1"></a>  </span>
<span id="cb54-18"><a href="#cb54-18" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb54-19"><a href="#cb54-19" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">sample</span>(z)</span>
<span id="cb54-20"><a href="#cb54-20" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> xy[<span class="dv">1</span><span class="sc">:</span>m]; y1 <span class="ot">&lt;-</span> xy[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>m)]</span>
<span id="cb54-21"><a href="#cb54-21" tabindex="-1"></a>    perm[i] <span class="ot">&lt;-</span> <span class="fu">cvm.test</span>(x1, y1)</span>
<span id="cb54-22"><a href="#cb54-22" tabindex="-1"></a>  }</span>
<span id="cb54-23"><a href="#cb54-23" tabindex="-1"></a>  perm[B <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> t0</span>
<span id="cb54-24"><a href="#cb54-24" tabindex="-1"></a>  </span>
<span id="cb54-25"><a href="#cb54-25" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(perm <span class="sc">&gt;=</span> t0)</span>
<span id="cb54-26"><a href="#cb54-26" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">t0 =</span> t0, <span class="at">perm =</span> perm, <span class="at">p =</span> p))</span>
<span id="cb54-27"><a href="#cb54-27" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>])</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>])</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">cvm.perm</span>(x1, x2, B)</span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">cvm.perm</span>(x2, x3, B)</span></code></pre></div>
<hr />
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>s1<span class="sc">$</span>p</span></code></pre></div>
<pre><code>## [1] 0.397</code></pre>
<p>CvM 检验下，大豆与亚麻籽差异的 <span class="math inline">\(p\)</span>
值并不显著。</p>
<hr />
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>s2<span class="sc">$</span>p</span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<p>CvM 检验下，向日葵与亚麻籽差异的 <span class="math inline">\(p\)</span> 值很显著。</p>
<hr />
</div>
</div>
<div id="exercise-8.3" class="section level2">
<h2>Exercise 8.3</h2>
<p>Count 5 等方差检验是基于最大极值点数的。 例 6.15 显示 Count 5
准则不能应用于容量不相等的两样本。 样本容量未必相等时，
基于最大极值点数， 使用置换检验来实现等方差检验。</p>
<hr />
<div id="解答-19" class="section level3">
<h3>解答</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>max.ext <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x); y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>  mx <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">&gt;</span> <span class="fu">max</span>(y)) <span class="sc">+</span> <span class="fu">sum</span>(x <span class="sc">&lt;</span> <span class="fu">min</span>(y))</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>  my <span class="ot">&lt;-</span> <span class="fu">sum</span>(y <span class="sc">&gt;</span> <span class="fu">max</span>(x)) <span class="sc">+</span> <span class="fu">sum</span>(y <span class="sc">&lt;</span> <span class="fu">min</span>(x))</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(mx, my)))</span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>}</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>max.ext.perm <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, B){</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(x); n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>  s0 <span class="ot">&lt;-</span> <span class="fu">max.ext</span>(x, y)</span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>  </span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>  perm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a>  </span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">sample</span>(z)</span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> xy[<span class="dv">1</span><span class="sc">:</span>m]; y1 <span class="ot">&lt;-</span> xy[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>m)]</span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a>    perm[i] <span class="ot">&lt;-</span> <span class="fu">max.ext</span>(x1, y1)</span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a>  }</span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a>  perm[B <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> s0</span>
<span id="cb60-21"><a href="#cb60-21" tabindex="-1"></a>  </span>
<span id="cb60-22"><a href="#cb60-22" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(perm <span class="sc">&gt;=</span> s0)</span>
<span id="cb60-23"><a href="#cb60-23" tabindex="-1"></a>  </span>
<span id="cb60-24"><a href="#cb60-24" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">s0 =</span> s0, <span class="at">perm =</span> perm, <span class="at">p =</span> p))</span>
<span id="cb60-25"><a href="#cb60-25" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">max.ext.perm</span>(x, y, <span class="dv">999</span>)</span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a>res1<span class="sc">$</span>p</span></code></pre></div>
<pre><code>## [1] 0.647</code></pre>
<p>两样本的容量不同，方差相同，检验得到的 <span class="math inline">\(p\)</span> 值不显著。</p>
<hr />
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">max.ext.perm</span>(x, y, <span class="dv">999</span>)</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>res2<span class="sc">$</span>p</span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<p>两样本的容量不同，方差不同，检验得到的 <span class="math inline">\(p\)</span> 值很显著。</p>
<hr />
</div>
</div>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
<div id="课后作业-1" class="section level2">
<h2>课后作业</h2>
<p>考虑模型</p>
<p><span class="math display">\[
{\rm P}(Y = 1| X_1,X_2,X_3) = \frac{\exp(a+ b_1X_1 + b_2X_2 + b_3X_3)}{1
+ \exp(a+ b_1X_1 + b_2X_2 + b_3X_3)},
\]</span></p>
<p>其中 <span class="math inline">\(X_1\sim {\rm Poisson}(1), X_2 \sim
{\rm Exp}(1), X_3 \sim {\rm Binom}(1,0.5)\)</span> 。</p>
<ul>
<li>设计一个函数，输入 <span class="math inline">\(N, b_1, b_2,
b_3\)</span> 与 <span class="math inline">\(f_0\)</span> ，输出 <span class="math inline">\(a\)</span> 。</li>
<li>调用此函数，输入为 <span class="math inline">\(N = 10^6, b_1 = 0,
b_2 = 1, b_3 = -1, f_0 = 0.1, 0.01, 0.001, 0.0001\)</span> 。</li>
<li>画出 <span class="math inline">\(\log f_0\)</span> vs <span class="math inline">\(a\)</span> 。</li>
</ul>
<hr />
<div id="解答-20" class="section level3">
<h3>解答</h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>a.compute <span class="ot">&lt;-</span> <span class="cf">function</span>(N, b, f0){</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N, <span class="at">lambda =</span> <span class="dv">1</span>); X2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N); X3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>  </span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>    tt <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span> a <span class="sc">-</span> b[<span class="dv">1</span>] <span class="sc">*</span> X1 <span class="sc">-</span> b[<span class="dv">2</span>] <span class="sc">*</span> X2 <span class="sc">-</span> b[<span class="dv">3</span>] <span class="sc">*</span> X3)</span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> tt)) <span class="sc">-</span> f0)</span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a>  }</span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a>  <span class="fu">return</span>(solution)</span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>)</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span>; b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lapply</span>(f0, a.compute, <span class="at">N =</span> N, <span class="at">b =</span> b)</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">sapply</span>(res, <span class="cf">function</span>(u) u<span class="sc">$</span>root)</span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">f0 =</span> f0, <span class="at">a =</span> a)</span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">f0</td>
<td align="center">0.100000</td>
<td align="center">0.010000</td>
<td align="center">0.0010</td>
<td align="center">0.00010</td>
</tr>
<tr class="even">
<td align="left">a</td>
<td align="center">-4.974079</td>
<td align="center">-9.665406</td>
<td align="center">-14.2569</td>
<td align="center">-18.60529</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(f0), a)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAAWlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmtv+QOgCQZgCQkGaQ2/+2ZgC2tma225C2/7a2///bkDrb////tmb/25D//7b//9v////YgPSwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALHUlEQVR4nO3djVIb2RWF0YYYZgJjEpQMshB6/9eMuhsMMQg39LnSRlqryi6XU7mSNR/9h31Pt4Fg3aHfALxHoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEq040A4mOVSgtctxrARKNIESTaBEEyjRBEo0gRJNoKR486GnQAnRbd7KQqBk6F78/Oq3J///ywiU/ydQogmUbK5ByeYunq9HoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEq0RoEuzu8295ddd3Zbshwnq02gQ59/bONcX38vWI7T1STQ9fXVNtKL/pfLbz9mL8cJaxTo983DzVX/y9X2WDp3OU5Yo1P89ui5dARlvjaBrq/P74ZD6GrXXZJAmaTVY6bVuPvoxa+rfHhfUk6b56BEaxno431S1XKcIoESTaBEEyjRBEo0d/FEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRKt1SCvrrt4uOm6bseYJIEyTZtA+9kei36D+mFi0uzlOF1NAn0x4MMYGmZpNsjrcYSXQV7M4ghKtMbXoDs3WRYok+z5Lt4gLz7Gc1CiGaJANIESTaBEEyjRBEo0d/FEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESrVGgw9aLWzv2Vxbo3nz1nS4bbWDbPe4psupsYHtQ3eaLf9bttgAf2QL8oLoXP39N7YYojAxROCiBvskRNIVA37Z82pveNeiBuQZ92/p6vIvfcfz84h/aV+IuvvHrctoESjSBEm3PgRrkxcc0eg76HKLnoMzR5gj6cLPzm/CfWY7T1ewvi1xULsfJanUNuvp1jOy85ThV7uKJJlCitQzUpDlmEyjRBEo0gRJNoERzF080gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRGsU6LLrxr1vlna3Y45GQxTObjfr637/MIEyS8MxNA83334IlHk+EejT9rS7twB9GuS1+PZDoMzyiUD77C4295e791f8+Q/iFxcCZZaPB7q+vtqs+pP3zhlIz1ee24OtQJnjM4F+39z/eTf82Olp1NzOvcAFyiQfD7Q/f6//un0/0LrX5bR94hq0P38vrt49xRe+LqftM4+ZFhfvXFxWvy6nzSAvohnkRTSDvIhmkBfRDPIimr8PSjSBEs0QBaIJlGgCJZpAiSZQormLJ5pAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiNQ30nUELAmUS2y8Src0RdNUN/57TEZS5Gp3i19f9DvYCZa5m16CLs1uBMlu7m6RldyVQ5mp4F39/+Q+BMlPbrW92b7MsUCbxoJ5oAiWaQV5E850kohnkRTSDvD7DJcreGOT1Cd3mi/8BvhB38R/XvfiZxgT6cQLdI0MUPk6geyTQT3ANuj8C/Qx38XsjUKIJlGju4okmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlWqNAF+d3m/vLrju7LVmOk9Um0KHPP277nUJ37CEmUCZptIHt1TbSYQPGZT/Qa+ZynLBGgX5/+kfxKzssM0ejU/z26Ll0BGW+NoGur8/vhkPoatddkkCZpN0Oy4OdG4ELlEk8ByWaQIkmUKLtOVCT5viYRs9BTZqjRpsjqElzFGl0ij/ySXPsTbvnoEc8aY79cRdPNIESzZQPogmUaAIlmkCJJlCiuYsnmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKK1GuTVdRcPN123cwMcgTJJm0D72R6LfoP6YWLS7OU4XU0CfTHgwxgaZmk2yOtxhJdBXsziCEq0xtegO/duECiTuIsnmuegRBMo0QRKNIO8iGaQF9EM8iKaQV5EM8iLaO7iiSZQohmiQDSBEi0pUI/veSUo0O5zr8JRywm0++zLcMxy7uIFyhsESrScQF2D8oagQN3F81pSoPCKQIkmUKIJlGgCJZpAiSZQogmUaAcLFCY5UKD7fcnCN5/4po57pdQXDP20Et/Uca+U+oKhn1bimzrulVJfMPTTSnxTx71S6guGflqJb+q4V0p9wdBPK/FNHfdKqS8Y+mklvqnjXin1BUM/rcQ3ddwrpb5g6KeV+KaOe6XUF4SPECjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEO0Cgy647u61a6TejGSdaPf5b2IrF7i+77jcTTacZh0uXLLW1+PajYpm6/3gT7T/QxfYPeH9ZkcJyu9Lvhod+wPq6IobVNoSale7/KCxh1ZUEujy/26z2WujeA11f9zNClgUf1zh6eVF1iBk+/NnGESglS60qFnm0PRpXBDr8x/vtyOtSew90/Pqr+CosDvT+cvd0nQ+sUnfYWxZ2sPz2r5pT/OZUAq04M9ee4hclB6zV+d/bS8eK1DeLf3ZFK/VfNkXXoJvxY9+fvQc6Xn4uS7paFV6xj5cesy27beclx5j1dZ/UouJd9dcdVYGuqr5oJjrUTVJFoP0xr+bEvKm56Ng8HV7qLh9LVuqv+OuOoA83ZUtNcIDHTIuuO//7r/k5PB6Li1qoegwzvJ2apxSbopWG6+K6QPd7G7/PQJfP11T3f87Kalip5nbr8U0VnOHHNzUGOu9W6eUHVbDSsuIp78v3VPblN8GBvpNU8Zhp/JyKzqZVH/r6uupNlf7xio6gxe9pigM8B72oOklUXoOWnbb6L7335kFPNzxAK7lJGlYrOcUvyv50U+3/CNp/B6+ohkXZc5iyS9nx26Y1b2pR9Z3cYbGaa9DS9zSFvyxCNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEE2ilcW+7Vx5uvvfbF149bQm9Ltgd9VQItNKOQJcX4/6j/RZ6wzZ6q33uUfy1CbTS24H2v9v/GPct7HdV7A+pTCLQSkOgP/dfXGxP6P/uD5rnd/34ufP/Pu9ZXrGB72kQaKU+0H4wzrBLb7+/7qq/5uyPmf3/Mm7nPexPvN9pbV+ZQCttMxzP49sAx+2yF2e3w+XnkO7zpvp73eb9SxNopW2GY3rbn8ed3Fd9oN9fBVo0lekECLTSz0C3v1g+BTr8zi+neIFOJdBK7x9BXwx2EuhUAq30+hp0+eIa9Pkxk2vQyQRa6f27+OcH9e7iJxNopVfPQc//01e6/TE+wl8+TeDxHHQqgbb1HOdLO74lymsCbeXx5r0/li5/nc7te/GTCbSZ1c8Brr9+693fZppOoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBE+x9wAZC229BRiwAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(a\)</span> 与 <span class="math inline">\(\log f_0\)</span> 大致成线性关系。</p>
<hr />
</div>
</div>
<div id="exercise-9.4" class="section level2">
<h2>Exercise 9.4</h2>
<p>实现一个生成标准 Laplace 分布的随机游走 Metropolis 采样子，
从正态分布模拟增量。 比较不同方差下的提议分布生成的链，
并计算每条链的接受率。</p>
<hr />
<div id="解答-21" class="section level3">
<h3>解答</h3>
<p>对于 Laplace 分布与 Metropolis 采样子， <span class="math inline">\(\alpha(x_i, y) = e^{-|y|} / e^{-|x_i|} = e^{|x_i|
- |y|}\)</span> 。</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>mh.Laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(N, x0, sigma){</span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>  <span class="co">#N: 链长度| x0: 初值| sigma: 正态分布标准差</span></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N <span class="sc">+</span> <span class="dv">1</span>); x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>  num.acc <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>  </span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(N<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a>    <span class="cf">if</span>(u[i<span class="dv">-1</span>] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(x[i<span class="dv">-1</span>]) <span class="sc">-</span> <span class="fu">abs</span>(y))){</span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a>      num.acc <span class="ot">&lt;-</span> num.acc <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a>    }<span class="cf">else</span> x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a>  }</span>
<span id="cb68-16"><a href="#cb68-16" tabindex="-1"></a>  </span>
<span id="cb68-17"><a href="#cb68-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">chain =</span> x, <span class="at">num.acc =</span> num.acc))</span>
<span id="cb68-18"><a href="#cb68-18" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span>; x0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">16</span>))</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sigma, mh.Laplace, <span class="at">N =</span> N, <span class="at">x0 =</span> x0)</span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>accept.rate <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="cf">function</span>(i) res[[i]]<span class="sc">$</span>num.acc <span class="sc">/</span> N)</span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="at">var =</span> sigma<span class="sc">^</span><span class="dv">2</span>, accept.rate)</span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">var</td>
<td align="center">0.1000</td>
<td align="center">0.5000</td>
<td align="center">1.0000</td>
<td align="center">2.0000</td>
<td align="center">4.0000</td>
<td align="center">16.0000</td>
</tr>
<tr class="even">
<td align="left">accept.rate</td>
<td align="center">0.8874</td>
<td align="center">0.7724</td>
<td align="center">0.7092</td>
<td align="center">0.6172</td>
<td align="center">0.5348</td>
<td align="center">0.3294</td>
</tr>
</tbody>
</table>
<p>方差越大，接受率就越小。</p>
<hr />
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="fu">plot</span>(</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>    res[[i]]<span class="sc">$</span>chain, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="fu">paste</span>(<span class="st">&quot;var = &quot;</span>, (sigma<span class="sc">^</span><span class="dv">2</span>)[i])</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="课后习题-3" class="section level2">
<h2>课后习题</h2>
<p>设 <span class="math inline">\(X_1,...,X_n \sim {\rm
Exp}(\lambda)\)</span> 。 出于某种原因，只知道 <span class="math inline">\(X_i\)</span> 落在某个区间 <span class="math inline">\((u_i, v_i)\)</span> 内， 其中 <span class="math inline">\(u_i&lt;v_i\)</span> 是非随机已知常数。
这种数据被称为区间删失数据。</p>
<ol style="list-style-type: decimal">
<li><p>试直接最大化观测数据的似然函数与使用 EM 算法来求解 <span class="math inline">\(\lambda\)</span> 的 <span class="math inline">\(\rm MLE\)</span> 。 证明 EM 算法收敛于观测数据的
<span class="math inline">\(\rm MLE\)</span>
，且收敛有线性速度。</p></li>
<li><p>设 <span class="math inline">\((u_i,v_i)\)</span> 为 <span class="math inline">\((11,12), (8,9), (27,28), (13,14), (16,17), (0,1),
(23,24), (10,11), (24,25), (2,3)\)</span> 。
试分别编程实现上述两种算法，以得到 <span class="math inline">\(\lambda\)</span> 的 <span class="math inline">\(\rm MLE\)</span> 的数值解。</p></li>
</ol>
<hr />
<div id="解答-22" class="section level3">
<h3>解答</h3>
<p>观测数据的似然函数为</p>
<p><span class="math display">\[\begin{aligned}
  L(\lambda; X^{(o)})
  &amp;= \prod_{i=1}^n {\rm P}_\lambda(u_i\leq X_i \leq v_i)
  \\ &amp;= \prod_{i=1}^n (e^{-\lambda u_i} - e^{-\lambda v_i}).
\end{aligned}\]</span></p>
<p>因此 <span class="math inline">\(\rm MLE\)</span> 满足</p>
<p><span class="math display">\[
\sum_{i=1}^n \frac{u_i e^{-\lambda u_i} - v_i e^{-\lambda
v_i}}{e^{-\lambda u_i} - e^{-\lambda v_i}} = 0.
\]</span></p>
<p>难以直接求解，可以数值求解。</p>
<hr />
<p>给定完整数据 <span class="math inline">\(X^{(o)}, X^{(m)}\)</span>
，</p>
<p><span class="math display">\[\begin{aligned}
  I_k(\lambda;X^{(o)})
  &amp;= {\rm E}_{\lambda_k} \left[\log L(\lambda; X^{(o)}, X^{(m)})
\big| X^{(o)}\right]
  \\&amp;= \sum_{i=1}^n \int_{u_1}^{v_1}\cdots \int_{u_n}^{v_n}
\log(\lambda e^{-\lambda x_i})\lambda_k^n e^{-\lambda_k (x_1+...+x_n)}
{\rm d} x_n \cdots {\rm d}x_1
  \\&amp;= \prod_{i=1}^n(e^{-\lambda_k u_i} - e^{-\lambda_k v_i}) \cdot
        \sum_{i=1}^n \frac{(e^{-\lambda_k u_i} - e^{-\lambda_k
v_i})\log\lambda - \lambda \left((1/\lambda_k + u_i)e^{-\lambda_k
u_i}  - (1/\lambda_k + v_i)e^{-\lambda_k v_i}\right)}{(e^{-\lambda_k
u_i} - e^{-\lambda_k v_i})},
\end{aligned}\]</span></p>
<p>最大化后得到</p>
<p><span class="math display">\[
\lambda_{k+1} =
\left(\frac{1}{\lambda_k} + \frac{1}{n}\sum_{i=1}^n \frac{u_i
e^{-\lambda_k u_i} - v_i e^{-\lambda_k v_i}}{e^{-\lambda_k u_i} -
e^{-\lambda_k v_i}}\right)^{-1}.
\]</span></p>
<hr />
<p>如果 <span class="math inline">\(\lambda_k\)</span> 收敛到 <span class="math inline">\(\hat\lambda\)</span> ，则</p>
<p><span class="math display">\[
\sum_{i=1}^n \frac{u_i e^{-\hat\lambda u_i} - v_i e^{-\hat\lambda
v_i}}{e^{-\hat\lambda u_i} - e^{-\hat\lambda v_i}} = 0.
\]</span> <span class="math inline">\(\hat\lambda\)</span> 就是 <span class="math inline">\(\lambda\)</span> 的 <span class="math inline">\(\rm MLE\)</span> 。</p>
<hr />
<p>令 <span class="math display">\[
f(\lambda) = \left(\frac{1}{\lambda} + \frac{1}{n}\sum_{i=1}^n \frac{u_i
e^{-\lambda u_i} - v_i e^{-\lambda v_i}}{e^{-\lambda u_i} - e^{-\lambda
v_i}}\right)^{-1},
\]</span></p>
<p>则 <span class="math inline">\(f\)</span> 单调递增。 <span class="math inline">\(f(\infty) = n / \sum u_i, f(0) = 0\)</span> ，即
<span class="math inline">\(f((0,\infty)) \subset (0, \infty)\)</span>
。 <span class="math inline">\(\exists\ 0 &lt; \alpha &lt; 1\)</span>
s.t. <span class="math inline">\(f&#39;(\lambda) &lt; \alpha\)</span> ，
<span class="math inline">\(f\)</span> 是 <span class="math inline">\((0, \infty)\)</span> 上的压缩映射。 因此 <span class="math inline">\(f\)</span> 一定有不动点，且 <span class="math inline">\(\lambda_k\)</span> 收敛到此不动点。</p>
<hr />
<p>由</p>
<p><span class="math display">\[
\frac{1}{\lambda_{k+1}} - \frac{1}{\hat\lambda} = \frac{1}{\lambda_k} -
\frac{1}{\hat\lambda} + \frac{1}{n}\sum_{i=1}^n \frac{u_i e^{-\lambda_k
u_i} - v_i e^{-\lambda_k v_i}}{e^{-\lambda_k u_i} - e^{-\lambda_k v_i}}
\]</span></p>
<p>知</p>
<p><span class="math display">\[
\frac{\lambda_{k+1} - \hat\lambda}{\lambda_k - \hat\lambda} =
-1 + \frac{\lambda_{k+1}\hat\lambda}{n\lambda_k} \frac{1}{\hat\lambda}
\cdot \frac{1}{\lambda_k - \hat\lambda}\sum_{i=1}^n \frac{u_i
e^{-\lambda_k u_i} - v_i e^{-\lambda_k v_i}}{e^{-\lambda_k u_i} -
e^{-\lambda_k v_i}}.
\]</span> 而</p>
<p><span class="math display">\[
\frac{1}{\lambda_k - \hat\lambda}\sum_{i=1}^n \frac{u_i e^{-\lambda_k
u_i} - v_i e^{-\lambda_k v_i}}{e^{-\lambda_k u_i} - e^{-\lambda_k v_i}}
\]</span></p>
<p>的极限为</p>
<p><span class="math display">\[
-\frac{1}{\hat\lambda}\sum_{i=1}^n\frac{u_i^2e^{-\hat\lambda u_i} -
v_i^2e^{-\hat\lambda v_i}}{e^{-\hat\lambda u_i} - e^{-\hat\lambda v_i}}
&gt; 0,
\]</span> 因此 <span class="math inline">\(\frac{|\lambda_{k+1} -
\hat\lambda|}{|\lambda_k - \hat\lambda|}\)</span> 的极限 <span class="math inline">\(&lt; 1\)</span> ， <span class="math inline">\(\lambda_k\)</span> 线性收敛。</p>
<hr />
<p>EM 算法：</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>lam.update <span class="ot">&lt;-</span> <span class="cf">function</span>(lam, u, v){</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>  uu <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>lam <span class="sc">*</span> u) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lam <span class="sc">*</span> v)</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> u <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lam <span class="sc">*</span> u) <span class="sc">-</span> v <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lam <span class="sc">*</span> v)</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>  </span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>  ss <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> lam <span class="sc">+</span> <span class="fu">mean</span>(ll <span class="sc">/</span> uu)</span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>  </span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> ss)</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>}</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>lam.em <span class="ot">&lt;-</span> <span class="cf">function</span>(init, u, v, <span class="at">tol =</span> <span class="fl">1e-5</span>){</span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>  est.old <span class="ot">&lt;-</span> init</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">lam.update</span>(init, u, v)</span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a>  </span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">abs</span>(est.old <span class="sc">-</span> est) <span class="sc">&gt;</span> tol){</span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a>    est.old <span class="ot">&lt;-</span> est</span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a>    est <span class="ot">&lt;-</span> <span class="fu">lam.update</span>(est, u, v)</span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a>  }</span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a>  <span class="fu">return</span>(est)</span>
<span id="cb71-19"><a href="#cb71-19" tabindex="-1"></a>}</span>
<span id="cb71-20"><a href="#cb71-20" tabindex="-1"></a></span>
<span id="cb71-21"><a href="#cb71-21" tabindex="-1"></a><span class="co">#(11,12), (8,9), (27,28), (13,14), (16,17), (0,1), (23,24), (10,11), (24,25), (2,3)</span></span>
<span id="cb71-22"><a href="#cb71-22" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">27</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">0</span>, <span class="dv">23</span>, <span class="dv">10</span>, <span class="dv">24</span>, <span class="dv">2</span>)</span>
<span id="cb71-23"><a href="#cb71-23" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">28</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">1</span>, <span class="dv">24</span>, <span class="dv">11</span>, <span class="dv">25</span>, <span class="dv">3</span>)</span>
<span id="cb71-24"><a href="#cb71-24" tabindex="-1"></a></span>
<span id="cb71-25"><a href="#cb71-25" tabindex="-1"></a>MLE1 <span class="ot">&lt;-</span> <span class="fu">lam.em</span>(<span class="dv">1</span>, u, v)</span>
<span id="cb71-26"><a href="#cb71-26" tabindex="-1"></a>MLE1</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
<p>直接求解：</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(lam, u, v){</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>  s <span class="ot">&lt;-</span> u <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lam <span class="sc">*</span> u) <span class="sc">-</span> v <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lam <span class="sc">*</span>v)</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>lam <span class="sc">*</span> u) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lam <span class="sc">*</span>v)</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(s <span class="sc">/</span> t))</span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a>}</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>MLE2 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f, <span class="fu">c</span>(<span class="fl">1e-3</span>, <span class="dv">1</span>), <span class="at">u =</span> u, <span class="at">v =</span> v, <span class="at">tol =</span> <span class="fl">1e-5</span>)</span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a>MLE2<span class="sc">$</span>root</span></code></pre></div>
<pre><code>## [1] 0.07197363</code></pre>
<p>两种方法的结果一致。</p>
<hr />
</div>
</div>
<div id="exercise-11.8" class="section level2">
<h2>Exercise 11.8</h2>
<p>在 Morra 博弈中，如果收益矩阵的每个元素都减去相同的常数，
或者乘上相同的正常数，则最优策略不变。 但是， simplex
算法可能会在不同的基本可行点（也是最优）停止。 计算 B &lt;- A + 2
，找到博弈 B 的解， 并验证它是 A 的极值点 (11.12) - (11.15) 之一。 计算
A 和 B 的价值。</p>
<hr />
<div id="解答-23" class="section level3">
<h3>解答</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A){</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>  min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>  max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>  it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>)</span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n))</span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>)))</span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a>  sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb75-15"><a href="#cb75-15" tabindex="-1"></a>      <span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb75-16"><a href="#cb75-16" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>)</span>
<span id="cb75-17"><a href="#cb75-17" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m))</span>
<span id="cb75-18"><a href="#cb75-18" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb75-19"><a href="#cb75-19" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>)))</span>
<span id="cb75-20"><a href="#cb75-20" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb75-21"><a href="#cb75-21" tabindex="-1"></a>  sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb75-22"><a href="#cb75-22" tabindex="-1"></a>  <span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb75-23"><a href="#cb75-23" tabindex="-1"></a>  soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,</span>
<span id="cb75-24"><a href="#cb75-24" tabindex="-1"></a>  <span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb75-25"><a href="#cb75-25" tabindex="-1"></a>  <span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb75-26"><a href="#cb75-26" tabindex="-1"></a>  <span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A)</span>
<span id="cb75-27"><a href="#cb75-27" tabindex="-1"></a>  soln</span>
<span id="cb75-28"><a href="#cb75-28" tabindex="-1"></a>}</span>
<span id="cb75-29"><a href="#cb75-29" tabindex="-1"></a></span>
<span id="cb75-30"><a href="#cb75-30" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb75-31"><a href="#cb75-31" tabindex="-1"></a>  <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb75-32"><a href="#cb75-32" tabindex="-1"></a>  <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb75-33"><a href="#cb75-33" tabindex="-1"></a>  <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb75-34"><a href="#cb75-34" tabindex="-1"></a>  <span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb75-35"><a href="#cb75-35" tabindex="-1"></a>  <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb75-36"><a href="#cb75-36" tabindex="-1"></a>  <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb75-37"><a href="#cb75-37" tabindex="-1"></a>  <span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb75-38"><a href="#cb75-38" tabindex="-1"></a>  <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb75-39"><a href="#cb75-39" tabindex="-1"></a>  <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb75-40"><a href="#cb75-40" tabindex="-1"></a></span>
<span id="cb75-41"><a href="#cb75-41" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb75-42"><a href="#cb75-42" tabindex="-1"></a>B <span class="ot">&lt;-</span> A <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb75-43"><a href="#cb75-43" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(B)</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(s<span class="sc">$</span>x, s<span class="sc">$</span>y), <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##       [,1]    [,2]
## x1 0.00000 0.00000
## x2 0.00000 0.00000
## x3 0.40984 0.40984
## x4 0.00000 0.00000
## x5 0.32787 0.32787
## x6 0.00000 0.00000
## x7 0.26230 0.26230
## x8 0.00000 0.00000
## x9 0.00000 0.00000</code></pre>
<p>simplex 算法在极值点 (11.15) 处停止了。</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>s<span class="sc">$</span>v</span></code></pre></div>
<pre><code>## x10 
##   2</code></pre>
<p>B 的价值为 <span class="math inline">\(2\)</span> ，A 的价值为 <span class="math inline">\(0\)</span> 。</p>
<hr />
</div>
</div>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
<div id="exercise-4" class="section level2">
<h2>2.1.3 Exercise 4</h2>
<p>为什么要使用 <span class="math inline">\(\texttt{unlist()}\)</span>
来将列表转换为原子向量， <span class="math inline">\(\texttt{as.vector()}\)</span> 不行？</p>
<hr />
<div id="解答-24" class="section level3">
<h3>解答</h3>
<p>因为列表也属于向量， <span class="math inline">\(\texttt{as.vector()}\)</span> 不会改变结果。
所以需要使用 <span class="math inline">\(\texttt{unlist()}\)</span>
。</p>
<hr />
</div>
</div>
<div id="exercise-1" class="section level2">
<h2>2.3.1 Exercise 1</h2>
<p><span class="math inline">\(\texttt{dim()}\)</span>
作用于向量后，会返回什么？</p>
<hr />
<div id="解答-25" class="section level3">
<h3>解答</h3>
<p>会返回 <span class="math inline">\(\texttt{NULL}\)</span> 。</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a><span class="fu">dim</span>(a)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<hr />
</div>
</div>
<div id="exercise-2" class="section level2">
<h2>2.3.2 Exercise 2</h2>
<p>如果 <span class="math inline">\(\texttt{is.matrix(x)}\)</span> 是
<span class="math inline">\(\texttt{TRUE}\)</span> ， <span class="math inline">\(\texttt{is.array(x)}\)</span> 会返回什么？</p>
<hr />
<div id="解答-26" class="section level3">
<h3>解答</h3>
<p>也返回 <span class="math inline">\(\texttt{TRUE}\)</span> 。</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">is.matrix</span>(x), <span class="fu">is.array</span>(x))</span></code></pre></div>
<pre><code>## [1] TRUE TRUE</code></pre>
<hr />
</div>
</div>
<div id="exercise-2-1" class="section level2">
<h2>2.4.5 Exercise 2</h2>
<p><span class="math inline">\(\texttt{as.matrix()}\)</span>
作用于各列类型不同的 data frame ， 会发生什么？</p>
<hr />
<div id="解答-27" class="section level3">
<h3>解答</h3>
<p>如果各列是不同精度的数值，则会将每个元素转换为当前最高精度。</p>
<p>如果是数值与字符混合，则转换为字符。</p>
<p>如果某列含列表，则转换为列表。</p>
<hr />
</div>
</div>
<div id="exercise-3" class="section level2">
<h2>2.4.5 Exercise 3</h2>
<p>data frame 能不能只有 <span class="math inline">\(0\)</span>
行？列？</p>
<hr />
<div id="解答-28" class="section level3">
<h3>解答</h3>
<p>都可以。</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> m[<span class="cn">FALSE</span>, <span class="cn">FALSE</span>]</span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>m</span></code></pre></div>
<pre><code>## &lt;0 x 0 matrix&gt;</code></pre>
<hr />
</div>
</div>
<div id="exercises-2" class="section level2">
<h2>11.1.2 Exercises 2</h2>
<p>以下函数能把向量缩放至范围在 <span class="math inline">\([0,1]\)</span> 内。</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>}</span></code></pre></div>
<p>如何将其作用于 data frame 的每一列？ 作用于 data frame
的每一数值列？</p>
<hr />
<div id="解答-29" class="section level3">
<h3>解答</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">9</span>), <span class="dv">3</span>, <span class="dv">3</span>)); x</span></code></pre></div>
<pre><code>##           V1         V2         V3
## 1 -0.2234777 0.58332722 -0.4127342
## 2  0.1471969 0.97033779 -0.4155289
## 3 -0.2258047 0.04723656  0.5315547</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>, scale01); y</span></code></pre></div>
<pre><code>##               V1        V2          V3
## [1,] 0.006238442 0.5807496 0.002950858
## [2,] 1.000000000 1.0000000 0.000000000
## [3,] 0.000000000 0.0000000 1.000000000</code></pre>
<hr />
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x, <span class="at">s =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)); x</span></code></pre></div>
<pre><code>##           V1         V2         V3 s
## 1 -0.2234777 0.58332722 -0.4127342 a
## 2  0.1471969 0.97033779 -0.4155289 b
## 3 -0.2258047 0.04723656  0.5315547 c</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>, <span class="cf">function</span>(u) <span class="cf">if</span>(<span class="fu">is.numeric</span>(u)) <span class="fu">scale01</span>(u) <span class="cf">else</span> u); y</span></code></pre></div>
<pre><code>##      V1           V2           V3           s  
## [1,] &quot;-0.2234777&quot; &quot;0.58332722&quot; &quot;-0.4127342&quot; &quot;a&quot;
## [2,] &quot; 0.1471969&quot; &quot;0.97033779&quot; &quot;-0.4155289&quot; &quot;b&quot;
## [3,] &quot;-0.2258047&quot; &quot;0.04723656&quot; &quot; 0.5315547&quot; &quot;c&quot;</code></pre>
<hr />
</div>
</div>
<div id="exercise-1-1" class="section level2">
<h2>11.2.5 Exercise 1</h2>
<p>使用 <span class="math inline">\(\texttt{vapply()}\)</span> 来：</p>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>计算数值 data frame 每一列的标准差。</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>计算混合 data frame 每一数值列的标准误差。</li>
</ol></li>
</ul>
<hr />
<div id="解答-30" class="section level3">
<h3>解答</h3>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">9</span>), <span class="dv">3</span>, <span class="dv">3</span>)); x</span></code></pre></div>
<pre><code>##            V1        V2         V3
## 1  0.01339598 0.3407015 -0.4730226
## 2 -0.48611715 0.4801454  1.1039945
## 3 -0.93384355 0.3496477  0.3663240</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">vapply</span>(x, sd, <span class="fu">numeric</span>(<span class="dv">1</span>)); y</span></code></pre></div>
<pre><code>##        V1        V2        V3 
## 0.4738556 0.0780537 0.7890546</code></pre>
<hr />
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x, <span class="at">s =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)); x</span></code></pre></div>
<pre><code>##            V1        V2         V3 s
## 1  0.01339598 0.3407015 -0.4730226 a
## 2 -0.48611715 0.4801454  1.1039945 b
## 3 -0.93384355 0.3496477  0.3663240 c</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">vapply</span>(</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a>  x[<span class="fu">vapply</span>(x, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))],</span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a>  sd, <span class="fu">numeric</span>(<span class="dv">1</span>)</span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>)</span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>##        V1        V2        V3 
## 0.4738556 0.0780537 0.7890546</code></pre>
<hr />
</div>
</div>
<div id="exercise-9.8" class="section level2">
<h2>Exercise 9.8</h2>
<p>考虑二元密度</p>
<p><span class="math display">\[
f(x, y) \propto \binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \ x=0,1,...,n, \
0\leq y\leq 1.
\]</span></p>
<p>固定 <span class="math inline">\(a, b, n\)</span> ，条件分布为 <span class="math inline">\({\rm Binom}(n,y)\)</span> 与 <span class="math inline">\({\rm Beta}(x+a, n-x+b)\)</span> 。 使用 Gibbs
采样来逼近此密度。</p>
<ul>
<li>编写一个 R 函数</li>
<li>编写一个 Rcpp 函数</li>
<li>使用函数 <span class="math inline">\(\texttt{microbenchmark}\)</span>
来比较两个函数的计算时间。</li>
</ul>
<hr />
<div id="解答-31" class="section level3">
<h3>解答</h3>
<p>R 函数：</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>gibbs_r <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, n, N){</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>  </span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, X[i<span class="dv">-1</span>, <span class="dv">2</span>])</span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, X[i, <span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">-</span> X[i, <span class="dv">1</span>] <span class="sc">+</span> b)</span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a>  }</span>
<span id="cb103-8"><a href="#cb103-8" tabindex="-1"></a>  </span>
<span id="cb103-9"><a href="#cb103-9" tabindex="-1"></a>  <span class="fu">colnames</span>(X) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb103-10"><a href="#cb103-10" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb103-11"><a href="#cb103-11" tabindex="-1"></a>}</span></code></pre></div>
<hr />
<p>Rcpp 函数：</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a><span class="st">NumericMatrix gibbs_rcpp(double a, double b, int n, int N){</span></span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a><span class="st">  NumericMatrix X(N, 2);</span></span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a><span class="st">  for(int i = 1; i &lt; N; i++){</span></span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a><span class="st">    X(i, 0) = R::rbinom(n, X(i-1, 1));</span></span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a><span class="st">    X(i, 1) = R::rbeta(X(i, 0) + a, n - X(i, 0) + b);</span></span>
<span id="cb104-10"><a href="#cb104-10" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb104-11"><a href="#cb104-11" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb104-12"><a href="#cb104-12" tabindex="-1"></a><span class="st">  return X;</span></span>
<span id="cb104-13"><a href="#cb104-13" tabindex="-1"></a><span class="st">}     </span></span>
<span id="cb104-14"><a href="#cb104-14" tabindex="-1"></a><span class="st">&#39;</span>)</span></code></pre></div>
<hr />
<p>计算时间对比：</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span>; b <span class="ot">&lt;-</span> <span class="dv">4</span>; n <span class="ot">&lt;-</span> <span class="dv">20</span>; N <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">gibbs_r</span>(a, b, n, N), <span class="fu">gibbs_rcpp</span>(a, b, n, N))</span></code></pre></div>
<pre><code>## Unit: milliseconds
##                    expr     min       lq     mean   median       uq     max
##     gibbs_r(a, b, n, N) 21.7100 28.02565 34.99988 34.66845 40.45740 59.2577
##  gibbs_rcpp(a, b, n, N)  1.8259  2.00610  2.14381  2.09545  2.23045  3.6194
##  neval cld
##    100  a 
##    100   b</code></pre>
<p>Rcpp 函数的效率要高得多。</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
